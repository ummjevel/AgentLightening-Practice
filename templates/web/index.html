{% extends "base.html" %}

{% block title %}í™ˆ - Paper Review Service{% endblock %}

{% block content %}
<div class="card">
    <h2>ğŸ” ë…¼ë¬¸ ê²€ìƒ‰ í•„í„°</h2>

    <form action="/papers" method="get">
        <div class="form-group">
            <label>ğŸ“Œ ì†ŒìŠ¤ ì„ íƒ</label>
            <div class="radio-group">
                <label><input type="checkbox" name="sources" value="arxiv" checked> arXiv</label>
                <label><input type="checkbox" name="sources" value="huggingface" checked> HuggingFace</label>
            </div>
        </div>

        <div class="form-group">
            <label>ğŸ“… ë‚ ì§œ ë²”ìœ„</label>
            <input type="number" name="days_back" value="1" min="1" max="30">
            <small>ìµœê·¼ Nì¼ ì´ë‚´ ë…¼ë¬¸</small>
        </div>

        <div class="form-group">
            <label>ğŸ·ï¸ arXiv ì¹´í…Œê³ ë¦¬</label>
            <input type="text" name="arxiv_categories" placeholder="cs.CV, cs.AI, eess.AS">
            <small>ì‰¼í‘œë¡œ êµ¬ë¶„ (ì˜ˆ: cs.CV, cs.AI, eess.AS)</small>
        </div>

        <div class="form-group">
            <label>arXiv í•„í„° ëª¨ë“œ</label>
            <div class="radio-group">
                <label><input type="radio" name="arxiv_filter_mode" value="OR" checked> OR (í•˜ë‚˜ë¼ë„ í¬í•¨)</label>
                <label><input type="radio" name="arxiv_filter_mode" value="AND"> AND (ëª¨ë‘ í¬í•¨)</label>
            </div>
        </div>

        <div class="form-group">
            <label>ğŸ”– HuggingFace í‚¤ì›Œë“œ</label>
            <input type="text" name="hf_keywords" placeholder="computer-vision, audio">
            <small>ì‰¼í‘œë¡œ êµ¬ë¶„ (ì˜ˆ: computer-vision, diffusion)</small>
        </div>

        <div class="form-group">
            <label>HuggingFace í•„í„° ëª¨ë“œ</label>
            <div class="radio-group">
                <label><input type="radio" name="hf_filter_mode" value="OR" checked> OR (í•˜ë‚˜ë¼ë„ í¬í•¨)</label>
                <label><input type="radio" name="hf_filter_mode" value="AND"> AND (ëª¨ë‘ í¬í•¨)</label>
            </div>
        </div>

        <button type="submit" class="btn">ğŸš€ ë…¼ë¬¸ ê²€ìƒ‰</button>
    </form>
</div>

{% if latest_report %}
<div class="card">
    <h2>ğŸ“Š ìµœê·¼ ê²€ìƒ‰ ê²°ê³¼</h2>
    <p>ì´ <strong>{{ latest_report.total_papers }}</strong>ê°œ ë…¼ë¬¸</p>
    <ul>
        <li>arXiv: {{ latest_report.arxiv_count }}ê°œ</li>
        <li>HuggingFace: {{ latest_report.huggingface_count }}ê°œ</li>
    </ul>
    <a href="/papers" class="btn">ê²°ê³¼ ë³´ê¸°</a>
</div>
{% endif %}

{% if is_running %}
<div class="alert alert-info">
    â³ ë…¼ë¬¸ ìˆ˜ì§‘ ë° ìš”ì•½ ì‘ì—…ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤...
</div>
{% endif %}
{% endblock %}

{% block extra_scripts %}
<script>
    // Convert checkboxes to comma-separated value
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
        const checkboxes = document.querySelectorAll('input[name="sources"]:checked');
        const values = Array.from(checkboxes).map(cb => cb.value).join(',');

        // Remove individual checkboxes
        checkboxes.forEach(cb => cb.remove());

        // Add hidden input with comma-separated values
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'sources';
        input.value = values;
        form.appendChild(input);
    });
</script>
{% endblock %}
